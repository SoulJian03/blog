<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>封装过程 on SoulJian小站</title><link>https://souljian.cn/tags/%E5%B0%81%E8%A3%85%E8%BF%87%E7%A8%8B/</link><description>Recent content in 封装过程 on SoulJian小站</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 21 Apr 2025 21:52:15 +0800</lastBuildDate><atom:link href="https://souljian.cn/tags/%E5%B0%81%E8%A3%85%E8%BF%87%E7%A8%8B/index.xml" rel="self" type="application/rss+xml"/><item><title>数据包封装过程</title><link>https://souljian.cn/p/745243535/</link><pubDate>Mon, 21 Apr 2025 21:52:15 +0800</pubDate><guid>https://souljian.cn/p/745243535/</guid><description>&lt;p&gt;我们以 &lt;strong&gt;10网段私有IP地址&lt;/strong&gt; 为例（比如你家/公司内网），重新还原整个过程，重点标注源IP和目的IP：&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-快递运输过程10网段ip版"&gt;📦 &lt;strong&gt;快递运输过程（10网段IP版）&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;假设你的电脑IP是 &lt;code&gt;10.0.0.2&lt;/code&gt;，要访问公司内网的服务器IP &lt;code&gt;10.20.1.100&lt;/code&gt;，流程如下：&lt;/p&gt;
&lt;h4 id="1-应用层对话"&gt;&lt;strong&gt;1. 应用层（对话）&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;• &lt;strong&gt;你的浏览器（Chrome）&lt;/strong&gt;
• 源IP：&lt;code&gt;10.0.0.2&lt;/code&gt;（你的电脑）
• 目的IP：&lt;code&gt;10.20.1.100&lt;/code&gt;（公司服务器）
• 请求内容：&amp;ldquo;请给我首页HTML文件&amp;rdquo;（写在快递单上的文字）&lt;/p&gt;
&lt;h4 id="2-运输层拆包贴标签"&gt;&lt;strong&gt;2. 运输层（拆包+贴标签）&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;• &lt;strong&gt;TCP协议处理&lt;/strong&gt;
• 源端口：随机生成（比如&lt;code&gt;54321&lt;/code&gt;，你的浏览器门牌号）
• 目的端口：&lt;code&gt;80&lt;/code&gt;（默认HTTP服务的门牌号）
• 动作：把&amp;quot;首页请求&amp;quot;拆成多个小包裹，每个包裹标注顺序号（类似快递箱编号1/3、2/3、3/3）&lt;/p&gt;
&lt;h4 id="3-网络层找路"&gt;&lt;strong&gt;3. 网络层（找路）&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;• &lt;strong&gt;路由器N1（你的网关）&lt;/strong&gt;
• 源IP：&lt;code&gt;10.0.0.2&lt;/code&gt;
• 目的IP：&lt;code&gt;10.20.1.100&lt;/code&gt;
• 查路由表：&amp;ldquo;去往&lt;code&gt;10.20.0.0/16&lt;/code&gt;网段，下一跳是路由器N2（IP &lt;code&gt;10.0.0.1&lt;/code&gt;）&amp;rdquo;
• 类似快递分拣员：&amp;ldquo;这个包裹是10.20网段的，走3号通道到N2！&amp;rdquo;&lt;/p&gt;
&lt;h4 id="4-数据链路层卡车运输"&gt;&lt;strong&gt;4. 数据链路层（卡车运输）&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;• &lt;strong&gt;从电脑到路由器N1&lt;/strong&gt;
• 源MAC地址：&lt;code&gt;AA:BB:CC:DD:EE:01&lt;/code&gt;（你的电脑网卡）
• 目的MAC地址：&lt;code&gt;AA:BB:CC:DD:EE:02&lt;/code&gt;（路由器N1的接口）
• 动作：通过网线/WiFi传输（卡车运输）&lt;/p&gt;
&lt;h4 id="5-物理层信号传输"&gt;&lt;strong&gt;5. 物理层（信号传输）&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;• 网线中的电信号或WiFi的无线电波，把二进制数据流（&lt;code&gt;01101000...&lt;/code&gt;）从电脑传到路由器N1。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="-完整路径含ip"&gt;🌐 &lt;strong&gt;完整路径（含IP）&lt;/strong&gt;
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;你的电脑 (10.0.0.2) → 路由器N1 → 路由器N2 → 公司服务器 (10.20.1.100)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;应用层&lt;/strong&gt;：浏览器发起请求 → 服务器返回网页&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;运输层&lt;/strong&gt;：TCP通过端口（源端口）&lt;code&gt;54321→80&lt;/code&gt;（目标端口）保证数据顺序&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络层&lt;/strong&gt;：IP地址（源IP）&lt;code&gt;10.0.0.2→10.20.1.100&lt;/code&gt;（目标IP）指引方向&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数据链路层&lt;/strong&gt;：MAC地址逐段接力传输（每经过一个路由器，源/目的MAC都会改变）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;物理层&lt;/strong&gt;：网线/WiFi承载光/电信号&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id="-关键点"&gt;💡 &lt;strong&gt;关键点&lt;/strong&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;IP地址的作用&lt;/strong&gt;：
• 类似快递收件地址，网络层靠IP地址决定包裹往哪送
• &lt;code&gt;10.x.x.x&lt;/code&gt;是私有IP（类似公司内部房间号），仅在局域网内使用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MAC地址的作用&lt;/strong&gt;：
• 类似卡车车牌号，数据链路层靠MAC地址完成&amp;quot;最后一公里&amp;quot;配送
• 每经过一个路由器（N1→N2），MAC地址都会更新，但IP地址始终不变&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;为什么用10网段？&lt;/strong&gt;
• 私有IP地址（10.0.0.0~10.255.255.255）专用于内网
• 避免和公网IP冲突，适合企业/家庭内部通信&lt;/li&gt;
&lt;/ol&gt;</description></item></channel></rss>